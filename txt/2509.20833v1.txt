[preprint,12pt]elsarticle
[margin=1in]geometry

[dvipsnames]xcolor

[1]Nidia Reyes-Gil
[2]Greg Thomsen
[3]Kristopher Rowe 
[1]Peter Diamessis

[1]organization=School of Civil and Environmental Engineering,
 addressline=Cornell University, 
 city=Ithaca,
 state=NY,
 country=USA

[2]organization=Wandering Wakhs Research,
 city=Austin,
 state=TX,
 country=USA

[3]organization=Leadership Computing Facility, Argonne National Laboratory,
 city=Lemont,
 state=IL,
 country=USA

We present the components of a high-order accurate Navier-Stokes solver designed to simulate high-Reynolds-number stratified flows. The proposed numerical model addresses some of the numerical and computational challenges that high-Reynolds-number simulations pose, facilitating the reproduction of stratified turbulent fluid dynamics typically observed in oceanic and atmospheric flows, namely the development of thin regions of high vertical shear, strongly layered turbulence at high Reynolds numbers and internal wave radiation. This Navier-Stokes solver utilizes a Fourier pseudo-spectral method in the horizontal direction and a modal spectral element discretization in the vertical. We adopt an implicit-explicit time discretization scheme that involves solving several one-dimensional Helmholtz problems at each time step. Static condensation and modal boundary-adapted basis functions result in an inexpensive algorithm based on solving many small tridiagonal systems. A series of benchmark studies is presented to demonstrate the robustness of the flow solver. These include two-dimensional and three-dimensional problems, concluding with a turbulent stratified wake generated by a sphere in linear stratification.\\

Stratified flows, Spectral methods, Stratified turbulence

Introduction

In oceanic and atmospheric flows at environmental scales, the combination of turbulence and density variations introduces additional layers of physical complexity to turbulent dynamics that are not yet fully understood. Turbulence reorganizes under the influence of stratification into coherent patches of vertical vorticity, that interact through focused shearing motions in the vertical and may trigger a full range of potential instabilities and complicated nonlinear dynamics. Furthermore, at high Reynolds numbers, turbulent fluid motions can persist even longer than in unstratified environments due to thin regions of high shear that can sustain turbulence far after the original turbulent event. In view of the complexity of the phenomenon, this intricate fluid dynamics are increasingly studied through numerical models, given the numerous practical challenges involved in in-situ data acquisition, the wide range of scales that need to be measured and the inherent difficulties to reproduce high-Reynolds-number flows in a stratified environment in the laboratory. 

Numerical models focused on reproducing unsteady turbulent flow through numerical computation, specifically by computing truncated or filtered solutions to the full incompressible Navier-Stokes equations (), can involve significant computational challenges with respect to resource utilization. Their computational limitations, in terms of execution time and memory footprint, depend on the range of leading scales of motion that need to be simulated: computing time is determined by the ratio of the total simulation time to the smallest resolvable time scale (or time step), and memory requirements by the ratio of the domain size to the smallest resolvable length scale . In particular, turbulent flows in stratified environments exhibit a broad range of scales in space and time, demanding immense computational resources that make their numerical simulation---accounting for all the length and time scales involved---practically impossible. Simulation strategies such as direct numerical simulations (DNS), large-eddy simulations (LES) and implicit large-eddy simulations (ILES) (see Section ), have been essential in studying turbulence in stratified environments. However, their main limitation---with respect to resource utilization---has been the range of temporal and spatial scales that can be simulated. 

An example of the limitation above is the numerical simulation of stratified turbulent wakes. Stratified wakes produced by islands, mountains, or seamounts, are a canonical example of stratified turbulent flow which can involve length scales of millimeters to kilometers and time scales from milliseconds to hours, and clearly pose important resource-utilization challenges to be simulated numerically. If we define a geometry based Reynolds number ($Re$), based on the characteristic velocity and length scales of the generating body, i.e. $Re=UD/$, the largest geometry-based $Re$ simulated numerically ($Re O(10^4$--$10^5)$ using ILES ) are still orders of magnitude below values typically observed in geophysical flows in nature ($Re O(10^8$--$10^10)$) . Efficient computational implementations, combined with high-order numerical models, offer a powerful tool to explore a broader parameter space and gain deeper insights into the complex non-linear dynamics of high $Re$ stratified flows, bridging at least partially the above gap in reference.

As a continuation of , and , this work describes a pseudo-spectral method for simulating the three-dimensional Navier-Stokes equations under the Boussinesq approximation. Particular care is taken to ensure that the model is suitable to simulate stratified turbulent wakes at a geometry-based $Re O(10^5-10^6)$. A defining feature of this work is the application of boundary-adapted polynomial basis functions combined with a domain decomposition approach in the vertical to increase efficiency. The model is well-suited for other stratified, highly turbulent flows developed in long, high aspect-ratio domains, such as shear and boundary layers and jets. To contextualize and delineate the document's objective and motivation, an overview of the key dynamics of stratified turbulent wakes is presented below, followed by a description of the proposed numerical model.

Simulation of stratified turbulent flows: studying wakes as test case

In stratified turbulence, the importance of stratification in the flow dynamics is estimated by comparing kinetic and potential energies. A dimensionless parameter used for such purpose is the Froude number, $Fr = N l$, where $l$ and $U$ correspond to appropriate length and velocity scales and $N$ to the stratification frequency or Brunt--V\"ais\"al\"a frequency. In general, when $Fr 1$ stratification effects are considered to be important, and the smaller $Fr$, the larger these effects are . 

Particularly in stratified flows at high $Re$, potential secondary instabilities due to buoyancy-driven shear can appear when the local (turbulent) $Fr$ is less than unity, which takes place at some point during the evolution of a decaying turbulent flow in stable stratification. This occurs during the so-called strongly stratified regime (SSR), where there is still a lack of understanding of turbulent dynamics (see ). Complex nonlinear motions in the SSR---including internal wave radiation , buoyancy-driven shear , and both space-filling and layered turbulence ---significantly influence vertical transport and diapycnal mixing in atmospheric and oceanic flows. 

The wake generated by a sphere towed in a linear stratification profile is a useful canonical model to study complex wake flows and turbulent dynamics in the SSR. A number of the laboratory studies that have addressed the decay of turbulence in stratified flows, particularly in the low $Fr$ number regime, have dealt with towed sphere wakes (see ). Results from those experiments can be considered representative of turbulence developed in a stably-stratified fluid, particularly those not sustained by ambient shear flow . In sphere wakes, the means of generating the turbulence is controllable, and the body-based $Re$ and $Fr$ can be easily varied. Moreover, its study is relevant to several geophysical and engineering applications. 

 
Numerical simulation of stratified turbulent flows is achieved by discretizing the incompressible Navier-Stokes equations under the Boussinesq approximation. In principle, it is possible to statistically model fluctuation-correlations using a Reynolds average Navier-Stokes approach. However, far more accurate simulation strategies are needed. Such strategies are increasingly interested in reproducing the main features of the unsteady turbulent flow through numerical computation, specifically by approximating truncated or filtered solutions to the full incompressible Navier-Stokes equations (). For the simulation of canonical fluid problems, such as sphere-wakes, there are at least three main simulation strategies available: 

 Direct numerical simulations (DNS), where the full Navier-Stokes equations are simulated resolving all the length and time scales involved. This approach is limited to diffusive flows with small $Re$, given the elevated computational cost associated to DNS.
 Large eddy simulations (LES), proposed by , where the computational cost is reduced by disregarding the small-scale information from the flow, and modeling the unresolved scales introducing a subgrid-scale (SGS) model
 Implicit large eddy simulations (ILES), initially proposed by , where the dissipative effects from unresolved scales (introduced by SGS models in LES) are now generated by the intrinsic numerical dissipation associated to the numerical discretization. This numerical dissipation depends on the discretization scheme, and it is the result of truncation errors and applying numerical techniques---such as spectral filtering---designed to maintain numerical stability in the solution. The reader is referred to for a discussion and a review of applications of spectral filtering for ILES strategies. 

In general, the results from any of the approaches above need to be compared against observations, experimental data or other numerical studies to evaluate if they are accurately reproducing the fluid flow dynamics. As summarized in , DNS investigations 
(), LES (), and ILES (), have reproduced the basic phenomenology of flow regimes in stratified sphere wakes, particularly for maximum body-based $Re$ values of $Re O(10^4)$ and $Re (10^5)$. Besides corroborating decay laws of kinetic energy dissipation and mean velocity profile, analysis of the results of numerical simulations have permitted the exploration of stratified wake dynamics associated to larger body-based $Re$ values than the one reproduced in laboratory experiments.

Although the basic phenomenology of the stratified turbulent wakes is relatively well understood at a qualitative level, the detailed processes that describe the transitions between flow regimes are not fully clear, particularly at higher $Re$ (). Similarly, exploring how the dynamics and persistence of the coherent vertical structures (or pancake vortices ()), and any fine-scale turbulence embedded therein, is modified for larger values of $Re$ will give additional insights on how turbulence evolve spatially and temporarily within the SSR (). It is also necessary to investigate further the role of mixing, viscous dissipation and internal wave radiation in the kinetic energy decay (). 

This study intends to address some of these questions by providing a computational tool that will enable us to reproduce the dynamics of stratified wakes at a even higher $Re$ than the ones simulated by , as high as $ O(10^6)$, where turbulent motions are expected to access the SSR in the intermediate to late time, and the radiation of internal waves is known to play an important role in the wake kinetic energy budget. The wake generated by a sphere, which is towed in uniform stratification, serves as a canonical flow to study the structure and dynamics of the turbulent event. In the context of implicit large-eddy simulations ILES, this work describes a numerical model to study the dynamics of turbulent stratified flows. 

Numerical model: overview of the flow solver

The flow solver presented in this work utilizes a pseudo-spectral method for simulating the three-dimensional Navier-Stokes equations under the Boussinesq approximation. Numerical discretizations based on high-order pseudo-spectral methods have emerged as compelling approaches for simulating turbulent stratified flows. Their high accuracy and exponential convergence enables the efficient reproduction of a broad range of length and time scales and, in schemes based on elemental discretizations, it allows us to localize resolution in areas of interest . Existing models include triply periodic discretizations (, ), and discretizations for complex boundary conditions and geometries using Chebyshev-collocation methods (), and Fourier-based techniques combined with higher-order element-based methods (, and ). 

In this work, the numerical model utilizes a Fourier spectral method in the horizontal direction and a modal spectral element method (SEM) discretization in the vertical or wall-normal direction. Using a modal SEM retains the flexibility of localized flow resolution in the vertical. Moreover, in combination with static condensation, the method results in a large number of small tridiagonal systems that allows us to have a Helmholtz solver algorithm that is as inexpensive as second-order finite difference schemes. 
The assumption of a horizontally periodic domain allowed us to use Fourier methods and existing optimized packages for computing Fourier transforms. In the vertical direction, the selection of polynomial basis functions for the spectral element method permitted exploiting matrices structure for performance of the algebraic solvers.
The computer code was designed to use mostly MPI programming and a hybrid MPI/OpenMP approach. Among the main libraries used are FFTW and NetCDF . Note that this work is inspired by the implementation of previous models for simulation of the incompressible Navierâ€“Stokes equations, particularly the high-order continuous Galerkin implementation presented in , and the discontinuous spectral multidomain penalty method approach used in , and .

Paper structure

The text is structured as follows. In Section , the model equations are presented, namely the Navier-Stokes equations under the Boussinesq approximation, followed by a description of the numerical discretization. The latter is divided in two parts: $i)$ the temporal discretization (subsection ) discussing the details of the implicit-explicit splitting scheme that defines the main components of the solver, or fractional steps, to integrate the field variables in time, and $ii)$ the spatial discretization of the governing equations (subsection ) with a description of the Fourier-based Galerkin method in the horizontal direction, and the modal spectral element method used in the vertical.

Section covers a series of unstratified and stratified Navier-Stokes benchmarks set up to evaluate and quantify the accuracy and stability of the flow solver, including the simulation of a stratified turbulent wake and the comparison of its main features with findings in the literature. Section offers discussion and concluding remarks. Finally, appendices A and B offer additional details on the calculation of nonlinear terms and stabilization techniques.

Equations and discretization
 

Mathematical model
 

The incompressible Navier-Stokes equations under the Boussinesq approximation (INSEB) are adopted as governing equations, given our interest in studying flows with relatively small density variations. The fluid density is expressed as the sum of three terms: $(x,y,z,t) = _0 + (z) + '(x,y,z,t)$, where $_0 '$. The quantity $_0$ represents a mean reference value, $$ is the horizontally averaged background stratification, and $'$ are the perturbations due to fluid motions . The flow velocity is represented by a vector field $$, with components $(u,v,w)$ in the $(x,y,z)$ directions, respectively. The INSEB equations are commonly written as,

 t + ( ) &= - _0 p' + ^2 - _0 , \\
 t + ( ' + ) &= ^2 ', \\
 &= 0, 

where $p'$ is the perturbation deviation from the hydrostatic pressure, after the hydrostatic balance has been subtracted from the $z$-momentum equation, and $$ and $$ are the kinematic viscosity and mass diffusivities. In the density equation, Eq.~(), the diffusion of the background density profile $(z)$ is ignored in the absence of any external motions.

Numerical discretization
 
The temporal discretization of the INSEB equations consists of a high-order fractional-step method. Its spatial discretization is based on the Galerkin principle; the Fourier-Galerkin method is utilized in the horizontal plane or periodic $x$ and $y$ directions, and a Legendre-Galerkin spectral element method in modal form is used in the vertical or non-periodic $z$ direction. 

 
The Karniadakis et al. scheme, an operator splitting referred to here as KIO, is a variant of the Chorin-Temam method . It consists of fractional steps with a mix of explicit-implicit schemes, specifically Adams-Bashforth methods and backward differentiation formulas , and high order pressure boundary conditions. Following the notation used in , the result of applying the KIO scheme to Eq.~(-), over one time step $ t$, is presented in the form of five steps that allow one to obtain the velocity field $$, and the scalar field of the density perturbations $'$ at the discrete time $t^(n+1)=(n+1) t$. The five steps are as follows: 

 
 Computation of nonlinear terms:
 
 ^*- _m=0^J_e-1 _m^n-m &= - t _m=0^J_ e-1 _m (^n-m,(')^n-m ), \\
 ( ,' ) &= + _0 , 
 
 where $^*$ represents an intermediate velocity field with components $(u^*,v^*,w^*)$, and $=[3,-3/2,1/3]$ and $=[3,-3,1]$ are the time-stepping coefficients of the third order $(J_ e=3)$ KIO scheme . The operator $ ( ,' )$ refers to the sum of the nonlinear terms, written in convective form, and the buoyancy term. Details regarding the spatial discretization and implementation of the non-linear term are provided in . 
 
 To initialize the method, the first time step uses $=[1,0,0]$ and $=[1,0,0]$, corresponding to time-stepping coefficients of a first order scheme $(J_ e=1)$. The second time step uses coefficient values of $=[2,-1/2,0]$ and $=[2,-1,0]$, corresponding to a second order scheme $(J_ e=2)$.

 
 Solution of a Poisson equation for the pressure and velocity update:
 
 ^**- ^* t = - ^n+1/2, 
 
 where $$ corresponds to a second intermediate velocity field with components \\$(u^**,v^**,w^**)$, and $^n+1/2$ to a time-integrated value of the pressure perturbation averaged over one time-step. By enforcing the incompressibility constraint $ =0$ in Eq.~(), a Poisson equation is obtained,
 
 ^2 ^n+1/2 = t ^*,
 
 
 with high-order pressure boundary conditions as specified in . Such boundary conditions are aimed towards ensuring high accuracy of the time-discretization scheme, and defined as follows, 
 
 ^n+1/2 z |_z= 0,~L_z= [ _m=0^J_ e-1 _m (^n-m,(')^n-m )+
 _m=0^J_ e-1 _m (- ( )^n-m) )]. 
 
 
 Consequently, the solution of $^n+1/2$ allows one to obtain the vector field $^**$ by reverting to Eq.~(), and computing, 
 
 ^** = ^* - t ^n+1/2. 
 

 
 Viscous term treatment:
 
 t~^n+1- ~^2 ^n+1 &= t ^**,
 
 
 where $_0=11/6$ is a time-stepping coefficient of the third order $(J_ e=3)$ KIO scheme.
 To initialize the method, the first time step uses $_0=1$, corresponding to a first order scheme $(J_ e=1)$, and the second time step uses $_0=3/2$, corresponding to a second order scheme $(J_ e=2)$, as specified in . Note that the boundary conditions for the velocity field $^n+1$ are enforced in Eq.~().
 
 Solution of advection problem for density perturbations:
 
 ^*- _m=0^J_e-1 _m (')^n-m &= - t _m=0^J_ e-1 _mR( ^n-m, (')^n-m, ), \\ 
 R( ,', ) &= ( ' + ), 
 
 where $^*$ is an intermediate scalar field and $R( ,', )$ represents the advective term of the density field. 
 
 Solution of a Helmholtz equation for $(')^n+1$: 
 
 t (')^n+1- ^2 (')^n+1 = t^*.
 
 

In summary, at every time-step, using the KIO scheme requires the solution of four Helmholtz equations: three for the velocity fields, Eq.~(), and one for the density perturbations, Eq.~(), one Poisson equation for the mean pressure perturbation, Eq.~(), and the computation of four nonlinear advective terms: one for the density perturbations, Eq.~(), and three for the velocity fields, Eq.~().

 

The periodic directions $x [0,L_x]$ and $y [0,L_y]$ define a two-dimensional domain denoted as $' ^2$. $ ^3$ denotes the extruded three-dimensional domain in the non-periodic direction $=' [0,L_z]$. As an example, the discretization of the first velocity component $u(x,y,z)$ will be presented below, as the other velocity components and field variables $$ and $'$ are treated in the same way.

The solution $u(x,y,z)$ at a given time-step is assumed to be approximated by a truncated Fourier series in the $x$ and $y$ directions,

 u = u(x,y,z) _j=-N_y/2^N_y/2_i=-N_x/2^N_x/2 ( k_x, k_y, z) ( k_x, k_y, x, y),
 

where $( k_x, k_y, x,y)=e^ 1mu ( k_x x + k_y y)$ are the Fourier basis functions, and $ k_x=(2/L_x) i$ and $ k_y=(2/L_y) j$ are the wavenumbers in the $x$ and $y$ directions, respectively. The unknown Fourier coefficients are represented by $( k_x, k_y,z) $, and $N_x$ and $N_y$ are the number of grid points in $x$ and $y$, respectively. Note that $( k_x, k_y, z)$ has complex-conjugate symmetry about $(k_x, k_y, z) = (0, 0, z)$ due to the fact that $u(x, y, z) $. Therefore, at a given $z$, one half-plane of the Fourier coefficients determines the rest, so that (for example) only $N_y/2$ Fourier coefficients in $y$, and $N_x$ Fourier coefficients in $x$, are required to represent $u$ in Eq.~(). In software, we make use of this more compact representation by choosing the first Fourier approximation to be computed in the $y$ direction (real-valued Fourier transformation, in which complex conjugation is implied).

Using a Fourier-Galerkin approximation , and by virtue
of the orthogonality of the Fourier basis functions, the first Helmholtz problem of Eq.~() is written in semi-discrete form below. Note that the wavenumber dependence of $^n+1$ and right-hand-side $^**$ are not included here to simplify notation. For a single horizontal wavenumber pair $( k_x, k_y)$, we write the $x$ component of Eq.~() as, 

 - z^2 ^n+1 + ( ||^2 + t ) ^n+1 = t ^**,
 

where $^n+1=^n+1( k_x, k_y,z) $, and $^**=^**( k_x, k_y,z) $ are the $( k_x, k_y)$ wavenumber pair Fourier coefficients representation of $u^n+1$ and $u^**$, respectively. The z contribution of the Laplacian operator is represented by $^2/ z^2 $, and its $x$ and $y$ components are written now in terms of the magnitude of the wavenumber pair $||^2=( k_x^2+ k_y^2)$. Such discretization now represents a series of Helmholtz problems in Fourier space that are independent of each other: one Helmholtz problem for every $( k_x, k_y)$ wavenumber pair. A similar approach is followed to write the discrete form of the second and third components of Eq.~(), as well as the Helmholtz problems for $^n+1/2$, Eq.~(), and $(')^n+1$, Eq.~(). 

The nonlinear term $ ( ,' )$ in Eq.~() is computed in a pseudo-spectral manner, as detailed in section 3.2.1. of . The gradient $ $ is calculated in spectral space (Fourier-Lobatto space), but the multiplication $ $ (expressed as a convective flux) is performed pointwise in physical space using discrete transforms. Stabilization techniques are discussed in Appendix A. Additional details on the treatment of the nonlinear terms can be found in . 

A continuous Galerkin finite element method is adopted, where additional degrees of freedom are added to the elements, and grid nodes are shared at the element interfaces. The local polynomial representation, however, does not correspond to a nodal expansion---where the interpolating Lagrange polynomial is used to represent the solution---but to a modal one, where a boundary-adapted basis is used instead. For more details regarding boundary-adapted bases and the differences between nodal and modal expansions, the reader is referred to .
The non-periodic domain defined by $z [0,L_z]$, $ $, is represented by an assembly of $N_e$ elements that populate the domain in the vertical direction. Let $ H^1 $ be a finite subspace spanned by polynomial functions up to order $N_p-1$, $=\_0(z),,_N_(z)\$. 
The solution $=( k_x, k_y,z)$ from Eq.~(), is approximated now by a sum of piecewise basis or expansion functions $_i(z)$: $=_i _i_i(z)$, where $i \1,,N_\$ is the index set, $=\ _1,...,_N_ \$ is the modal representation of $$, and $N_$ is the total (global) number of degrees of freedom in $$. The global functions $_i(z)$ are expressed in terms of local functions $_p(z)$ in every element,

=_i=1^N_ _i_i(z)=_e=1^N_e _p=0^N_p-1 _p^e_p^e(z),

where $N_p$ is the polynomial order of the expansion, $N_e$ is the number of elements, and the superscript $e$ denotes the element in which the $N_p-1$ order local expansion takes place. Since the method is continuous, every element shares one mode with each of its neighbouring elements (i.e. $_N_p-1^1=_0^2$ and $_N_p-1^2=_0^3$). Note that the global number of degrees of freedom $N_=N_e (N_p-1)+1$ is smaller than than the total number of local degrees of freedom $M_z=N_e N_p$. A procedure known as direct stiffness summation, or global assembly (see ), reassembles the global expansion from the local expansion on every element. Then, operations can be performed locally inside the elements and assembled to compute global operations---such as integrals---in $$. The reader is referred to for additional details on the fundamental concepts behind finite element methods and direct stiffness summation.

In the reference domain $r [-1,1]$, $L_k$ is the Legendre polynomial of $k^th$ order that satisfies the recursion relation, 

 L_0(r)&= 1 \\
 L_1(r)&= r \\
 L_k+1(r)&= k+1rL_k(r) - k+1L_k-1(r), & 2 k N. 

Then, the boundary-adapted basis of modal type $_k$ () is defined as, 

 _0(r)&= 2(L_0(r)-L_1(r)) \\
 _1(r)&= 2(L_0(r)+L_1(r)) \\
 _k(r)&= (L_k-2(r)-L_k(r)), & 2 k N. 

The basis $_k$, described in detail in , was originally proposed by Babuka and collaborators to be used in the p-version of the finite-element method. Non-orthogonal by design, it is composed of two linear functions (or boundary basis functions $_0$ and $_1$) that are nonzero at the end of the interval, and a series of internal or bubble functions that oscillate in the interior and vanish at both endpoints. The first seven modes of $(r)$ are illustrated in Fig.~. An affine mapping, $z(r)$, is introduced to write the local modal expansion from Eq.~(), $_p _p^e_p^e ( z(r) )$, in every element. The mapping $z(r)= z_l^e+2 h^e$, where $h^e=z_r^k-z_l^k$ is the element length and $z_r^e$ and $z_l^e$ are the element interfaces, supports elements that non-uniformly spaced. 

Under the Galerkin approximation, where the test functions $$ are chosen to be $=_i _i(z)$---with $i \1,,N_\$, the weak form of the Helmholtz problem in Eq.~() is written as follows,

a _0^L_z z ^n+1 z~dz + b _0^L_z ^n+1~dz = _0^L_z ^**~dz + a [ ^n+1 z ]_0^L_z, 

where $a=-$ and $b=( ||^2 + _0/ t )$. Assuming homogeneous Neumann boundary conditions for $$, the matrix form of Eq.~() is expressed as,

(a K+ b M ) ^n+1 = 
A ^n+1 = 

where $^n+1=^n+1( k_x, k_y) $ is the vector of modal coefficients of $^n+1=^n+1( k_x, k_y,z)$, $=( k_x, k_y) $ is the right hand side vector $=M ^**+$ , and $A=(a K + b M)$ is the resulting Helmholtz operator. Note that $K$ and $M$ correspond to the global assembled stiffness and mass matrices () representing the inner products,

K_ij&=_ dz dzdz, \\
M_ij&=_ _i _j dz, 

where $i,j \1,...,N_\$. The entries of the matrices $K$ and $M$ that correspond to each element (local matrices) can be computed exactly, following the expressions presented in section 8.5 of , with a subsequent assembly of the shared element interfaces, using direct stiffness summation. In regard to the right-hand side vector, an $L^2$ projection on the basis functions $(z)$ is used to obtain the right-hand-side coefficients $^**=\ ^**_1,...,^**_N_ \$ from the known values of $^**=^**( k_x, k_y,z)$, where $^**=_i ^**_i_i(z)$.

Dirichlet boundary conditions in Eq.~() are enforced by updating the right-hand side vector in a procedure known as ``lifting" (), while Neumann boundary conditions are included in the weak formulation naturally through integration by parts (see Eq.~()). The contribution of the Dirichlet boundary conditions prescribed for $u^n+1$ in Eq.~() is incorporated in the term $$ on the right-hand side. For details regarding implementation of Dirichlet boundary conditions in the weak form, the reader is referred to . 

A similar weak-form-based formulation is used to write the discrete form of the Helmholtz problems for the $v^n+1$ and $w^n+1$ velocity components in Eq.~(), as well as for $^n+1/2$, Eq.~(), and $(')^n+1$, Eq.~(). Note that the values of $a$ and $b$ of every Helmholtz operator $A=(a K + b M)$ are varied according to each Helmholtz problem. For example, for every $( k_x, k_y)$ wavenumber pair, the discrete form of the pressure Eq.~() is written as,

( aK+bM ) ^n+1/2&=, 

 where $^n+1/2=^n+1/2( k_x, k_y) $ is the modal representation of $^n+1/2$, and $=( k_x, k_y) $ is the right hand side $= tM ( ^*)+$. The term $$ accounts for the contribution of the Neumann boundary conditions for the pressure as defined in Eq.~(). In this case, the Helmholtz operator $A=(a K + b M)$ utilizes $a=1$ and $b=||^2$.

Similarly, the discrete form of the density Eq.~(),
 
(aK+ bM ) ^n+1&= ,

where $^n+1=^n+1( k_x, k_y) $ is the modal representation of $(')^n+1$, and the right-hand-side $( k_x, k_y)$ is computed as $= tM ( ^*)$. Throughout this work, homogeneous Neumann boundary conditions are prescribed for $(')^n+1$. The Helmholtz operator $A=(a K + b M)$ in Eq.~() is defined by $a=$ and $b=( ||^2 + _0/ t)$.

One of the main advantages of the selection of particular basis functions, $(z)$, is the emergence of global mass and stiffness matrices that are banded: $K$ is triadiagonal but can be alternatively represented in terms of a diagonal and a tridiagonal block (or submatrix), and $M$ has a pentadiagonal structure that can be described in terms of two tridiagonal blocks and coupling coefficients. Sparsity patterns of the stiffness and mass matrices are illustrated in Fig.~ for conventional (lexicographic) and alternative ordering/indexing of unknowns. The alternative ordering results in an favorable banded matrix structure that will be exploited for performance in the implementation of the Helmholtz solver (see Sec. ). 

Helmholtz solver: domain decomposition and Schur complement in the non-periodic domain
 
The solution of the linear systems in the form of Eq.() (such as Eq.~() or ()) leverages two techniques: Gaussian elimination and static condensation, also known as substructuring , where the unknowns are ordered in groups based on their location in the computational domain $$. The unknowns are grouped by collecting first the interior or bubble modes and then the vertex or boundary modes. The discrete Helmholtz operator $A=(aK+bM)$ is represented as a block matrix,

 & \\
 & \\
 

 \\
 \\
 =

 \\
 \\

where $A_II$ contains the interior mode contributions for all the elements, $A_BB$ the element boundary modes coefficients, and $A_IB$ and $A_BI$ represent the coupling between the interior and the boundary modes. In Eq.~(), the unknowns $$, $$ and right hand side entries $$, $$ are indexed accordingly.

The result of grouping the unknowns in this way is the emergence of sparsity patterns that are conducive to increasing the performance of the Helmholtz solver. As can be seen in Fig.~, where interior, boundaries, and coupling entries have been colored differently and reorganized, the resulting matrix blocks have a tridiagonal structure, which allows us to employ a commonly used form of Gaussian elimination for tridiagonal systems: the Thomas algorithm. 

To solve the linear system of Eq.~(), first, we solve for the coefficients corresponding to the boundaries $$, and second for the interiors $
$. In the first stage of the domain decomposition, the unknowns $$ are eliminated via a block Gaussian elimination, and Eq.() is condensed into a Schur complement system, 

S^(1)=g^(1)

where $S^(1)$ is the Schur complement matrix and $g^(1)$ is its right hand side. $S^(1)$ and $g^(1)$ are computed as follows,

S^(1) &= - )^-1 \\
g^(1) &= - )^-1 

Solving the linear system of Eq.~() requires the inversion of $A_II$, which is performed by computing an $LDL^T$ factorization, and using backward and forward substitution. Note that the solution of $$ and $$ only involves tridiagonal systems. The particular tridiagonal structure of $A_II$, where the interior modes of each element are decoupled, enables performing the inversion $A_II^-1$ for all the elements in parallel. In general, the entries of $S^(1)$ are computed in an element-wise fashion, with a subsequent assembly of the shared element interfaces using direct stiffness summation . 
The discrete Helmholtz operator $A=(aK+bM)$ that results from the Poisson problem in Eq.(), where $a=1$ and $b=||^2$, involves pure Neumann boundary conditions. When solving for the horizontal wavenumber pair $(k_x,k_y)=(0,0)$, the resulting operator, $A=K$, is singular and requires regularization to fulfill the solvability condition (see and ). Specifically for this case, an additional level of static condensation is applied over the tridiagonal system $S^(1) = g^(1)$. The grid points corresponding to element interfaces are organized into two groups,

 S^(1)_II & S^(1)_IE \\
 S^(1)_EI & S^(1)_EE \\
 

 _B_I \\
 _B_E \\
 =

 g^(1)_I \\
 g^(1)_E \\

where unknowns corresponding to the two-element interfaces at the boundaries of the computational domain are identified as $_B_E$, and the element interfaces located in the interior of the domain are identified as $_B_I$. The second Schur complement system corresponds to the Schur complement matrix $S^(2)$ and its right-hand side $g^(2)$,

S^(2) = S^(1)_EE - S^(1)_EI ( S^(1)_II )^(-1) S^(1)_IE \\
g^(2) = g^(1)_E-S^(1)_EI ( S^(1)_II )^(-1) g_I^(1)

 The required normalization is applied to a reduced system $S^(2)_B_E=g^(2)$ that only contains interactions of the leftmost boundary mode with the rightmost boundary mode. By static condensation, instead of regularizing the original system of the rank of $S^(1)$ (total number of elements in $$), one regularizes a system of rank 2. The treatment of the singularity is done using an augmented (bordered) system , where the null singular value is removed by applying a correction to the right-hand-side vector . For details regarding the treatment of the singular system, the reader is referred to and .

Navier-Stokes benchmarks
 

Results of a series of benchmark problems are used to validate the flow solver. The benchmark problems are listed in increasing complexity, allowing for a progressive evaluation of the solver's capabilities. Accuracy is assessed by comparing global quantities of the flow, such as domain-integrated kinetic energy and enstrophy, against published studies or experimental data. The first benchmark involves a two-dimensional and three-dimensional collision of a vortex dipole with a no-slip wall. This is followed by a more complex two-dimensional case of an internal solitary wave in uniform-depth water.

Normal collision of a vortex dipole with a no-slip wall

The accurate simulation of the collision of a dipole with a no-slip wall, as described by , has become an appropriate test case to evaluate the reliability of numerical implementations of the INSEB equations. This benchmark tests the solver's capabilities to predict the trajectories of two mutually interacting monopoles and reproduce the formation of finer-scale vortex features in the boundary layer. Using the same approach followed by and , a two-dimensional collision is first simulated, followed by an extension to three dimensions. Accuracy is measured by computing global quantities of the flow, such as total kinetic energy, enstrophy, and vorticity distribution at the boundary.

For the two-dimensional case, the $x$-$z$ plane is used to define a computational domain $x [-1,1]$ and $ z [-1,1]$. Following , the initial condition is defined by the two-dimensional velocity field $=(u,w)$,

u &= 2 (z - z_1) e^(-r_1^2/r_0^2) - 2 (z - z_2) e^(-r_2^2/r_0^2) \\
w &= 2 (x - x_2) e^(-r_2^2/r_0^2) - 2 (x - x_1) e^(-r_1^2/r_0^2) 

where $_0$ is the dimensionless maximum vorticity value at the center of each monopole. The location of the center of the positive and negative monopole are represented by $(x_1, z_1)=(-0.1,0)$ and $(x_2,z_2)=(0.1,0)$, with radius $r_0=0.1$. $r_1$ and $r_2$ are the radial coordinates with origin at the positive and negative monopole centers, respectively. The value of $_0=299.5284$ is selected to match the parameters used in . Vorticity contours of the initial velocity field are presented in panel $(a)$ of Fig.~.

The total kinetic energy of the flow field,

 KE(t) = 2 _-1^1_-1^1 ^2(,t) dx dz, 

is normalized to be $KE(0)=2$ for the initial condition. The initial total enstrophy,

(t) = 2 _-1^1_-1^1 ^2(,t) dx dz

is computed from the scalar vorticity field $$ and it has an initial value of $(0) 800$ for all the cases. The Reynolds number, $Re=UH/$ (where $U=1$m/s is the average RMS velocity and $H=1$m is the half height of the computational domain, as in ), is increased by decreasing the kinematic viscosity $$ only.

Simulations are performed for three different spatial resolutions by increasing the number of grid points in the $x$ and $z$ directions. The minimum horizontal and vertical grid spacing is reported in Table , where the point count is selected to match in both directions. In $z$, a constant polynomial order of $N_p-1=7$ is used for all the choices of number of elements $N_e$. The grid is stretched vertically upward so that features within the bottom boundary layer are better resolved. The stretching strategy consists of using a constant ratio $_z=h^e+1/ h^e 1$ to determine the heights of successive elements. The grid points within each element are the Gauss-Lobatto-Legendre (GLL) points which are non-equidistant. Numerical experiments have been performed for five different Reynolds numbers: $Re=625,~1250,~2500,~5000,~10000$.

Contour plots of the vorticity field, before and after the first collision, are presented in Fig.~. As expected, a boundary layer is formed at the bottom boundary as the dipole approaches it. After the first collision occurs, a high-amplitude vorticity region detaches from the boundary and contributes to forming an asymmetric dipole (see Fig.~$(c)$). The asymmetric dipole moves away from the boundary following a curved trajectory that approaches the boundary again before a second collision takes place (see Fig.~$(d)$). 

As the Reynolds number increases, the magnitude of the vorticity generated at the boundary grows, and additional small vortices and vorticity filaments are created. Fig.~ shows the vorticity contours of the positive signed primary vortex before the second collision takes place for different $Re$ values. The presence of smaller-scale flow structures with increasing $Re$ is evident. However, the trajectory of the positive signed primary vortex is barely impacted by the Reynolds number, in agreement with the observations reported by . 

The simulation results show that every collision of the primary vortex with the no-slip wall generates an increase in the vorticity production at the bottom boundary, and therefore, a peak in the total enstrophy value (as reported by ). These peaks are visible in the time-series plot of Fig.~, where the evolution of the total enstrophy is presented for several $Re$ and the spatial resolutions from Table . The figure indicates the times of the first and second collisions, which are more intense for the highest $Re$ cases. A lower-intensity third collision can only be distinguished for the two highest $Re$ values. 

To offer a broader summary of the results of the flow solver, Fig.~ compares the first enstrophy peak and its time of occurrence against values reported by previous studies (). The latter studies emply numerical discretizations based on pseudospectral Chebyshev methods (), Fourier/Chebyshev expansions (), and spectral element/Fourier-Galerkin schemes (). The results of the flow solver show the expected variation of enstrophy with respect to $Re$. For instance, Fig.~ confirms that the maximum enstrophy at the time of the first collision scales as Enstrophy$(t_1) Re^0.8$, as reported by . The enstrophy values and collision times associated with the first collision are detailed in Table . 

The accuracy of the enstrophy peak and time of occurrence increases with finer spatial resolution. For example, a finer grid produces differences in the results in the $Re=10000$ case (see Fig.~). Such results approach the values reported by as the grid point count increases from $512 512$ to $1024 1024$ points. As a reference, used an even finer grid, $1536 1024$ points, to simulate the latter $Re$ case. Given that the flow solver reproduces the expected flow dynamics for this Navier-Stokes benchmark, as well as the differences in the enstrophy as $Re$ increases, the differences in values concerning other studies are mainly attributed to time step and actual grid resolution.

Lastly, note that the findings resulting from this series of collisions of a dipole with a no-slip wall are useful to validate the flow solver, but may not have a physical meaning due to its two-dimensionality. In a three-dimensional setting, the vorticity production at the no-slip boundary is expected to be more intense, with flow structures and vortex trajectories qualitatively different due to mutual interactions in the added transverse direction.

Following the same approach as , the simulation of the vortex dipole collision can be extended to a three-dimensional domain when Gaussian noise is added to the initial velocity field. The flow structure generated at the wall undergoes a three-dimensional instability and can transition to turbulence. To assess the impact of the amplitude of the noise, as proposed by , two values of standard deviation ($$) of the white noise are evaluated. The Gaussian white noise standard deviation values correspond to $:10^-2,~10^-3$. To illustrate the phenomenon, Fig.~ shows an isosurface of the magnitude of the vorticity $||=( _x^2 + _y^2 + _z^2 )^1/2$, as well as two isosurfaces of the transverse vorticity, $_y$, for the $=10^-3$ case. The vorticity structures in the transverse direction indicate the three-dimensionalization of the flow. Note that the selected spatial resolution, for the $x$ and $z$ directions, corresponds to $N_x N_z=512 512$ (see Table~). In $y$, the computational domain defined by $y [0,0.4]$ is discretized using $96$ grid points and a uniform grid spacing $ y=4.16 10^-3$. 

Differences in the evolution of kinetic energy and enstrophy are expected for the different $$ values. For the stronger perturbations ($=10^-2$), a faster (bypass) transition to turbulence is anticipated, as well as the formation of richer three-dimensional fine-scale structures in the flow. In contrast, for the weaker perturbations ($=10^-3$), the transition to turbulence and formation of small three-dimensional structures is expected to develop at a slower rate, with a lower production of vorticity at the bottom boundary, and less kinetic energy dissipation due to the lack of three-dimensional flow structures. 

The simulation results reflect the expected dynamics. The $y$-average enstrophy and kinetic energy follow the same behaviour reported by , where the three-dimensional cases resemble the behaviour of the two-dimensional case until the primary vortex collides against the no-slip wall for the first time (see Fig.~). At this point, the enstrophy for the different values of $$ shows a different evolution. The weaker perturbation case ($ = 10^-3$) continues to follow the two-dimensional benchmark until the transverse flow structure grows, before the second collision, and generates a stronger peak of enstrophy of the same order of magnitude as the first one. For the stronger perturbations ($ = 10^-2$), the three-dimensionalization starts right after the first collision takes place, earlier than in the $ = 10^-3$ case, and a decay in kinetic energy is observed earlier than with $ = 10^-3$ (see bottom of Fig.~). 

Specifically for the three-dimensional case, Fig.~ shows a comparison of the $y$-averaged enstrophy against the results reported by and . The evolution of the enstrophy is similar to the one indicated by , although the peak values are less intense than reported by . These variations are attributed to differences in the structure of the noise and the spatial resolution used in the $x$ direction, which is finer, particularly in , where $ x_min = 3.249 10^-4$. 

Tankscale ISW in uniform depth water

The propagation of a tankscale internal solitary wave (ISW) in uniform depth water, with a continuous two-layer stratification, assesses the numerical dissipation and dispersion of the solver and its ability to simulate strongly nonlinear and non-hydrostatic effects. The numerical scheme has to be able to correctly reproduce the sensitive balance between nonlinear steepening and physical dispersion. Moreover, the wave amplitude should not artificially attenuated by numerical diffusion and no spurious trailing waves should emerge due to numerical dispersion. 

The initial wave is an exact solution of the Dubreil-Jacotin-Long (DJL) equation. The latter is a nonlinear eigenvalue problem which produces a wavefield that is an exact solution of the full Euler equations under the Boussinesq approximation. A reliable incompressible Euler solver, with a DJL generated ISW as initial condition, should reproduce a wave that honors the above balance between nonlinearities and dispersion, and maintains a constant waveform, propagation speed and wave-integrated kinetic energy. As such, this benchmark is purely inviscid and non-diffusive mode. 

As in , the two-layer stratification profile is described by,

 = _0 - 2( )

where $ = 40~$ is the difference in density between the two layers, $h=3~$ is the upper layer depth and $ = 0.5~$ is the interface thickness. The reference density, $_0$, is equal to $1000~$ and the initial available potential energy of the ISW is $0.05~$. Per the above discussion, the wave is expected to propagate at a speed of $c=0.1145~$, preserving its initial width, $L_w$, which is set to be $L_w 0.69~$. The streamwise two-dimensional domain has a total length of $L = 10 L_w = 6.9~$ and a depth of $H=15~$. Isopycnal contours of the ISW used as initial condition are generated using the method of and presented in Fig.~. 

Table shows the number of grid points in each direction and the minimum horizontal and vertical grid spacing used in the simulations. The number of points was chosen to match the setup used in . All elements have the same length and use a seventh-order polynomial ($N_p-1=7$) within each element. We performed different numerical experiments varying the intensity of the spectral filtering, which is designed to preserve numerical stability (see Appendix A) and controls, for the most part, the numerical diffusion in the flow solver. A series of exponential filter order values: $32,~20,~16,~14,~12$, were evaluated to assess their effects on the magnitude of the numerical dissipation. In the order listed, they vary from a very weak filter function, where numerical dissipation is expected to be minimal and restricted to the smallest length scales, to a strong one, where numerical dissipation is anticipated to have an effect on a broader range of length scales in the flow. 

The simulated ISW indeed maintains its shape as it travels at a constant speed. Using a linear fit of the location of the wave over time, we estimate its propagation speed to be $c_=0.1144774~$ (see left panel in Fig.~). In the numerical experiments we performed, the propagation speed differed from the theoretical prediction by less than $0.1\

KE = 2 _ ^2 (,t) d .

 
In the absence of viscous dissipation, $KE$ is expected to remain constant. Any deviations from its initial value are attributed to numerical dissipation of the flow solver. The evolution of the normalized---by its initial values---KE, as a function of time and filter order, is reported in Fig.~. As expected, a stronger numerical filter increases the rate at which the KE decreases. After two characteristic wave-propagation time scales, the KE can decrease from $0.05\

Stratified turbulent wakes
 
A stratified turbulent wake with non-zero net momentum is used to evaluate the capabilities of the flow solver to reproduce highly turbulent flow developing in a stably stratified fluid. Experimental work and wake theory for a towed sphere wake, as well as other numerical studies, allow us to evaluate the correctness of the solver by comparing flow features and power decay laws, particularly for the mid stages of the wake evolution. An overview of the validation approach and simulation setup is presented below.

The setup is similar to the one used by and , and it consists of a three-dimensional box of dimensions $L_x L_y L_z = 8D 2D 1.8D$, where $D$ is the sphere diameter. The sphere has moved through the box from left to right at a constant speed $U$, and it is not included in the simulation (see diagram in Fig.~). Given that the total wake length is considered too long to simulate in a single computational domain, the flow is simulated in a box of size $L_x L_y L_z$, shorter than the total wake length. The simulation approach follows , where the wake is considered statistically homogeneous in $x$, and time evolution of the flow is interpreted as the downstream variation of the wake . Under this assumption, selecting a computational domain length $L_x$ much smaller than the total wake length allows us to use periodic boundary conditions in the $x$ direction. We also assume periodic boundary conditions in the $y$ direction, where the width $L_y$ is chosen to be large enough to prevent interactions of the wake with its own periodic image. The reader is referred to for additional details on the wake simulation setup. 

Note that $L_x$ is selected to double the size used in , as a way of attending to one of their recommendations regarding the need to improve late-time statistics of the simulated turbulent flow. A longer domain is particularly critical for the $Re O(10^6)$ case, where large scale flow structures with layered turbulence are expected at late times (during the SSR), requiring a domain long enough to capture their length scale while satisfying the assumption of statistical homogeneity in $x$. 

 In these body-exclusive simulations, the mean and turbulent velocity fields at a short distance downstream from the sphere are approximated to build the initial condition; these approximations are based on the assumption of an axisymmetric wake . Details on the initialization process, and linking the particular initial mean/fluctuating velocity profiles to a sphere with diameter $D$ and speed $U$, are described in . The body-based $Re$ and $Fr$ are computed as follows,

 Re = ,

 Fr = ND.

The magnitude of the Reynolds number is varied by decreasing the kinematic viscosity coefficient $$, and the Froude number $Fr$ by modifying the value of the stratification frequency $N$ that describes the background density profile $$ in the vertical direction, $(z) = -N^2 (_0/g) z$.

Numerical experiments have been performed for three different Reynolds numbers with and without the influence of stratification. Simulations will be presented for three values of body-based $Re$: $Re=5 10^3,~1 10^5,~4 10^5$. We use a linear stratification profile with a $Fr$ equal to $4$. The number of grid points in each direction and minimum grid spacing are reported in Table . Again, $Re$ is increased by decreasing the value of the kinematic viscosity $$. Note that the temporal evolution of the velocity fields is presented in terms of non-dimensional $Nt$ units, where $N$ is the Bruntâ€“VÃ¤isÃ¤lÃ¤ or stratification frequency, and $t$ is time.

For the present, we have obtained results of the simulation at a higher body-based $Re$, i.e. $Re=1.6 10^6$, until the early stages of the stratified simulation ($Nt 12$) only, given the large demand of computational resources involved. The reader is referred to for an overview of the latter results. Stratified simulations for lower $Re$ values have been obtained for longer integration times ($Nt 50$). A summary of the results is offered in the next section. 

At a qualitative level, the simulation results exhibit flow dynamics expected for stratified sphere wakes when evaluating quantities such as vorticity and horizontal divergence. 
To give the reader a better sense of the fine spatial resolution we are solving for, Fig.~ and offer a view of the total domain length, by showing vorticity contours on the $z/D=0$ and $y/D=0$ planes at $Nt=50$. The zoom-in view in the figures, reveals the presence very fine scale structures in the $Re=4 10^5$ case, compared to the total length of the computational domain. High spatial resolution allows us to represent a very long domain, in the homogeneous direction, while having very fine-scale structures in the flow. 

Two layers of opposite-signed vorticity can be distinguished, with flow structures that look fundamentally different on the horizontal plane ($z/D=0$, see Fig.~) and the vertical plane ($y/D=0$, see Fig.~). The stratified wake growth is not symmetric around the wake centerline, as it is the case for its unstratified counterpart. On the vertical plane, the stratified wake is narrower than in the horizontal, and inclined shear layers start to form due to stratification. As expected, the wake height is constrained by the density differences in the vertical and internal waves begin to emerge. On the contrary, in the horizontal direction the wake spreads at a faster pace and larger-scale vorticity structures, or quasi-horizontal motions, can be distinguished. The development of these quasi-horizontal motions can be observed in more detail in the evolution of the $z-$oriented vorticity field in Fig.~. For the $Re=4 10^5$ case, large scale vortices are clearly distinguishable after $Nt=50$, along with fine-scale flow structures that are intermittent through the flow. On the contrary, the evolution of the $y-$oriented vorticity does not show the development of larger scale structures; the characteristic length scale of the flow in this direction seems to lock over time. Nevertheless, highly localized regions of shear are clearly established, as illustrated in the evolution of the $y-$oriented vorticity in Fig.~. As expected, the wake width growth is accompanied by shear instabilities in the vertical direction. The length scale of these flow features, however, changes with $Re$.

The difference in the amount of small-scale structures that can be captured, as $Re$ increases, is evident when comparing results across $Re$. Snapshots of vertical and span-wise vorticity are presented in Fig.~ and Fig.~ for the $Re: 5 10^3$ and $1 10^5$ cases, at $Nt=50$. Fine scale flow structures and vertical shear are clearly intensified for increasing $Re$. Large scale vortices in the $z-$oriented vorticity contours (see Fig.~) are observed for all the $Re$ cases, but small-scale structures and instabilities are present thorough the flow only for the larger $Re$ values. To offer the reader an additional point of comparison, vorticity contours with the same zoom-in view initially presented in Fig.~ and for $Re=4 10^5$, are now shown for lower $Re$: $Re=5 10^3$ in Fig.~ and , and $Re=1 10^5$ in Fig.~ and . Small-scale flow structures and vertical shear can trigger additional instabilities in fully developed turbulence and, practically, more vorticity. As $Re$ increases, the range of possible vertical vorticity values grows, as well as its magnitude. An increase in the amount of vorticity in the flow is expected: the range of possible values of vorticity expands when $Re$ increases, indicating that the flow becomes more vortical, more turbulent. 

For two $Re$ values, Fig.~ presents a cross-section in the $y$-$z$ plane of the horizontal divergence, $_z = u / x + v/ y$, as its non-zero values outside the wake core indicate the presence of internal wave motions in the flow. As reported by the latter, the radiation of internal waves at earlier times is evident, and the angle of propagation of internal wave rays is comparable to the approximate value of $45^$ from the vertical reported in laboratory data .

 

As discussed in , stratified wakes establish a constant wake height $L_V$, corresponding to the non-equilibrium (NEQ) regime , followed by a transition to a $x/D^3/5$ growth rate in the quasi-two-dimensional (Q2D) regime. The expected development of $L_V$ during the NEQ regime is reproduced by the flow solver, as shown in bottom-right panel of Fig. , where $L_V/D$ is compared against values reported by . The evolution of wake mean centerline velocity $U_0$ and wake width $L_H$ are also reported and compared in Fig. . As in the previous section, the wake velocity and length scales ($U_0$, $L_V$ and $L_H$) were computed by fitting a Gaussian profile to the mean $u(x,r)$ velocity, specifically at the horizontal and vertical center planes ($z/D=0$ and $y/D=0$). For the period of time that was simulated, the results show the expected trend in terms of self-similar decay of characteristic velocity and length scales. 

Performing and analyzing extended numerical simulations, as well as offering a detailed discussion on the wake dynamics for the highest $Re$ cases (including the $Re=1.6 10^6$ simulation) will be part of future research work. The fact that the flow solver is capable of accessing and reproducing properly the mean flow dynamics at the highest body-based $Re$ values that have been previously simulated gives us confidence in the capabilities of the flow solver to simulate high-Reynolds-number stratified wakes. 

Concluding remarks
 
This study presents a newly developed numerical model for solving the three-dimensional, incompressible Navier-Stokes equations under the Boussinesq approximation. The flow solver utilizes a Fourier pseudo-spectral method in the horizontal direction and a modal spectral element discretization in the vertical direction. It was developed as a continuation of , and it is specially designed to simulate highly turbulent stratified flow using an implicit large eddy simulation (ILES) strategy. The element discretization gives the user the flexibility of using non-uniform grids in the vertical direction, facilitating the representation of thin horizontal regions of high shear, typical of turbulent stratified flows, and enabling finer spatial resolution in regions of interest. A boundary-adapted basis of modal type in combination with static condensation leads to an inexpensive algorithm based on solving small tridiagonal systems. Spurious divergence at element interfaces is strongly contained and we are able to employ lower order polynomials than . Spectral filtering and over-integration in Lobatto space are applied to address problems of numerical stability caused by under-resolution. This approach enables the examination of high $Re$ dynamics even when full spatial resolution is not achievable due to limitations of computational resources. 

A series of benchmark studies were selected to asses the accuracy of the numerical model. Such test cases include two-dimensional and three-dimensional problems, with and without uniform density profiles. The benchmarks were evaluated in order of complexity, concluding with a turbulent stratiï¬ed wake generated by a sphere in a linear stratification profile. The flow solver correctly captures power law exponents and key flow features of the wake in a linear stratification profile, showing good agreement with previous numerical studies (). The implementation of the numerical model meets the design goals and enables the simulation of sphere wakes at the highest body-based $Re$ values that have been previously simulated in the literature, particularly in the context of LES and DNS studies. We are currently performing the simulation of an even higher body-based $Re$, i.e. $Re=1.6 10^6$, using the flow solver (see ). The results of the latter exercise will be reported in a forthcoming publication.

Future numerical simulations of sphere wakes will be performed employing this solver, with the purpose of examining turbulent wake dynamics in a broader range of $Re$ and $Fr$ values. Analysis of such results will enable the characterization of the dynamics of the strongly stratified regime in terms of transitional sub-regimes, flow structures, and evolution of velocity and length scales. Investigating internal wave radiation by the wake into the near and far field will also be possible using tools like those utilized by . The proposed numerical model is well-suited for investigating additional applications in environmental flow modeling, given its flexibility in local flow resolution in the vertical direction and its ability to simulate high-Reynolds-number flow dynamics in stratified environments. Such applications may include boundary-layer problems, turbulent jets, and mixing processes triggered by internal wave radiation. 

Apendix A. Stabilization techniques: exponential filtering

In environmental flow modeling, relying on under-resolved simulations, aliasing effects are commonly addressed by using an exponential filter, as described by . A surrogate of the hyperviscous operator (), the low pass filter function introduces an scale-selective artificial dissipation required to mitigate aliasing driven spectral instabilities. The range of length scales to be filtered and strength of the dissipation is controlled by adjusting the filter parameters, typically the filter order $s$. 

As in , the filtering process takes place once every time-step after the non-linear term computation. It involves multiplying each velocity component and the density field by an exponential filtering diagonal matrix $$, in each spatial direction separately,in Fourier-Lobatto space. Following , the one-dimensional matrix $$ is defined as,

_ii= ( N),~i=1,, N.

where $N-1$ is the order of the Fourier or polynomial expansion in each direction, and the filter function $$ follows the expression,

() = 
 1 & 0 _c \\
 exp( - ( 1-_c )^s ) & _c 1 

As in Eq.(5.16) of , $$ is a function of machine epsilon $_M$, $=(_M)$ and $_c=N_c/N$. In the flow solver, $$ is applied in each direction ($x$, $y$ and $z$) in its one-dimensional form. For all the numerical experiments listed in this work, the cutoff $N_c$ is set to be equal to zero, and the structure of the filter function is fully determined by the order $s$, which can take different values in each direction ($x$, $y$ and $z$).